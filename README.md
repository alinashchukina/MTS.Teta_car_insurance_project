# MTS.Teta Сar insurance project

## Прогнозирование возникновения страховых случаев по данным автострахования для резервирования денежных средств на возмещение по страховым случаям.

### 1.  Выбор проекта

Проект будет реализован в сфере автострахования. Рынок страхования демонстрирует свой рост на протяжении  последних 10 лет. Ведущие компании на российском рынке активно внедряют технологии искусственного интеллекта в свой бизнес.

Благодаря проекту мы планируем снизить средства, заложенные в бюджет на возмещение по страховым случаям. Модель будет предсказывать вероятность наступления страхового случая. Благодаря этому компания сможет:
* Выяснить переизбыток бюджета на выплату, следовательно в дальнейшем распоряжаться этими денежными средствами на другие нужды. 
* Минимизировать риски нехватки денежных средств на выплату страховых случаев.
* Предложить клиентам оптимальную стоимость страховки.

Зная в дальнейшем параметры клиентов, сможем создать программу, которая будет:
* Автоматически рассчитывать сумму страховых взносов
* Персонализировано подбирать клиенту лучший тариф
* Рационально планировать бюджет
 
### 2.  Бизнес и математическая постановки задачи

Цель проекта - Установить бюджет на возмещение денежных средств по страховым случаям. Спрогнозировать оптимальную стоимость страховых взносов.
Успешность внедрения проекта, мы сможем определить по уровню лояльности клиента, притоку новых клиентов компании, освободившимся денежным средствам при планировании бюджета с помощью программы.

Спрогнозировать возникновение страховых случаев у автовладельцев.
Следует оптимизировать Recall.

### 3.  Выбор набора данных

В этом проекте используются данные, предоставленные платформой Kaggle: [Car Insurance Data](https://www.kaggle.com/sagnik1511/car-insurance-data), с помощью которых исследуется поведение клиентов страховой компании, выдающей автомобильные страховки. На основании социально-демографических данных, исторических данных о пользовании автомобилем и других предоставленных данных о клиенте определяется факт и вероятность требования страховой выплаты.

### 4.  Валидация данных и оценка потенциала

Исследование данных и построение baseline модели приведено в ноутбуке [Car_claims_prediction.ipynb](https://github.com/alinashchukina/MTS.Teta_car_insurance_project/blob/main/Car_claims_prediction.ipynb).

### 5.  Оценка экономического эффекта

Страховая фирма планирует бюджет, который должен быть в запасе, чтобы она смогла заплатить клиентам по страховкам, в случае наступления страхового случая. Для этого для каждого клиента необходимо рассчитать оптимальную стоимость страховки. Стоимость не должна быть слишком высокой (клиенты способны ее заплатить и не уйдут к конкурирующей фирме), и не должна быть слишком низкой (при наступлении страхового случая компания сможет выплатить необходимую сумму клиенту). Нужно чтобы суммарная стоимость страховок покрывала будущие расходы фирмы на выплаты по ним.

$N$ – суммарное число клиентов, купивших страховку на транспортное средство;

$i$ – отдельный $i$-ый клиент;

$sum_i$ – стоимость страховки для $i$-го клиента;

$R$ – базовая сумма выплат по страховке;

$k_i$ – дополнительная ставка при выплате по страховке, в зависимости от типа страхового случая; 

$p_i$ – вероятность наступления страхового случая (предсказывает модель);

$limit$ – ограничение на выплату страховки (компания выплачивает не более этой суммы клиенту);

$err$ – средняя ошибка модели.

Суммарная выручка от продаж страховок должна быть больше расходов на выплаты по страховкам умноженные на вероятность наступления страхового случая: 
$$\sum_{i=1}^{N} (sum_i - (R + k_i) \cdot p_i) > 0$$

Ограничение на выплаты отдельно взятому клиенту:
$$R+k_i \leq limit$$

Следовательно:
$$k_i\leq limit - R$$

Получаем формулу примерной суммы, которая должна быть у компании (вместо $k_i$ подставляем полученное на него ограничение):
$$\sum_{i=1}^{N} sum_i \geq \sum_{i=1}^{N} limit \cdot p_i$$

Так как не у всех клиентов наступает страховой случай, то стоимость страховки для $i$-го клиента $\geq (R+err) \cdot p_i$

Если не применять модель для расчета вероятности наступления страхового случая, то фирме придется иметь сумму больше, чтобы ей точно хватило денег на выплаты по страховым случаям. C применением модели компания рассчитывает стоимость страховки более оптимально (клиенты не уходят к конкурентам, так как стоимость страховок не завышена).

Без модели прибыль: $N \cdot t \cdot limit - \sum_{i=1}^{N \cdot t} (R + k_i)$, где $t$ – доля клиентов, ушедших к конкуренту из-за высокой стоимости страховки.

С применением модели прибыль: $\sum_{i=1}^{N} limit \cdot p_i - \sum_{i=1}^{N} (R+k_i) \cdot p_i$

Экономический эффект = с применением модели прибыль - без модели прибыль =
$$\sum_{i=1}^{N} limit \cdot p_i - \sum_{i=1}^{N} (R+k_i) \cdot p_i - (N \cdot t \cdot limit - \sum_{i=1}^{N\cdot t} (R + k_i)) = [N \to \infty] = limit \cdot mean(p) - R \cdot mean(p) - mean(K) * mean(p) - \infty + \infty = mean(p) \cdot (limit - R - mean(K)) \geq 0 \ \ [limit \geq R + mean(K)]$$

Прибыль с применением модели выше, чем без ее применения. Плюсы от применения модели: компания не теряет клиентов, компании хватает денег на выплаты при наступлении страхового случая.

Чем выше качество предсказания модели, тем точнее будет рассчитываться необходимая сумма на счете компании, и тем меньше клиентов уйдет к конкурентам (конкуренты не смогут предложить ставку ниже, не неся при этом убытки), доля оттока $t$ снизится, а значит даже при низкой вероятности наступления страхового случая фирма будет получать выше прибыль, чем без применения модели.

Чем ниже качество модели, тем сильнее компания будет перестраховываться и завышать стоимость страховки, а значит доля оттока $t$ увеличится (а она была бы высокой и без применения модели) – экономический эффект от применения модели будет ниже.

Эффект от роста качества модели:

Пусть мы предсказываем вероятность наступления страхового случая с ошибкой модели $err$:

Прибыль_предсказанная = $\sum_{i=1}^{N} limit \cdot p_i - \sum_{i=1}^{N} (R+err) \cdot p_i = [N \to \infty] = mean(p) \cdot (limit - R - mean(err))$

При росте качества модели на 1% (потери снижаются на 1%) :

Прибыль_предсказанная_new = $mean(p) \cdot (limit - R - mean(err \cdot 0.99))$

Выигрыш в прибыли (по сравнению с предыдущей моделью) = $mean(p) \cdot (limit - R - mean(err \cdot 0.99)) - mean(p) \cdot (limit - R - mean(err)) = 0.01 \cdot mean(e) \cdot mean(p)$

При росте качества модели на 10%:

Выигрыш в прибыли = $mean(p) \cdot (limit - R - mean(err \cdot 0.9)) - mean(p) \cdot (limit - R - mean(err)) = 0.1 \cdot mean(e) \cdot mean(p)$

С ростом качества модели средняя ошибка уменьшается, значит фирма может продавать страховку по более точным ставкам, а значит получать прирост в прибыли.

